{% extends 'demo/base.html' %}

{% block title %}发帖{% endblock %}
{% block page_title %}发帖{% endblock %}
{% block page_id %}post_create{% endblock %}
{% block hd_buttons %}<a class="submit" href="javascript:void(0)">发表</a>{% endblock %}

{% block bd %}
<form id="post_form" action="" class="{% if not form.is_bound %}new{% endif %}" method="post">
    {% csrf_token %}
    {{ form.as_p }}
</form>
<div id="addrbar">
    <span class="stat"></span>
    <span class="addr">{{ params.addr }}</span>
    <span class="lat">{{ params.lat }}</span>
    <span class="lng">{{ params.lng }}</span>
    <a class="teleport" href="javascript:void(0)">[传送门]</a>
</div>
<script>
(function($){
    var j_form = $('#post_form'),
        j_submit = $('#hd .submit'),
        j_txt = j_form.find('textarea');
        
    j_submit.addClass('off');
    
    s.init_addrbar({
        'form': j_form, 
        'callback': function(e){
            j_submit.removeClass('off').
                click(function(){
                    j_form.submit()
                });
        }}
    );
    
    j_txt.width(j_form.width()-10);
    
    if(j_form.hasClass('new')){
        j_txt.one('focus', function(){
            j_txt.empty()
            j_form.removeClass('new');
        });
    }
})(jQuery);
</script>
{% endblock %}

